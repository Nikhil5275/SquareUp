"use strict";(()=>{var e={};e.id=475,e.ids=[475],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6090:e=>{e.exports=import("stripe")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,i){return i in t?t[i]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,i)):"function"==typeof t&&"default"===i?t:void 0}}})},5631:(e,t,i)=>{i.a(e,async(e,r)=>{try{i.r(t),i.d(t,{config:()=>u,default:()=>l,routeModule:()=>d});var n=i(1802),o=i(7153),s=i(6249),a=i(3954),c=e([a]);a=(c.then?(await c)():c)[0];let l=(0,s.l)(a,"default"),u=(0,s.l)(a,"config"),d=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/stripe/check-account-status",pathname:"/api/stripe/check-account-status",bundlePath:"",filename:""},userland:a});r()}catch(e){r(e)}})},3951:(e,t,i)=>{i.d(t,{C:()=>d,i:()=>u});let r=require("firebase-admin"),n=require("path");var o=i.n(n);let s=require("fs");var a=i.n(s);let c="firebase-service-account.json";if(!global._firebaseAdminApp){if(c)try{let e=o().join(process.cwd(),c);if(a().existsSync(e)){let t=a().readFileSync(e,"utf8"),i=JSON.parse(t),n=["project_id","private_key","client_email"].filter(e=>!i[e]);n.length>0?console.error(`Service account JSON missing required fields: ${n.join(", ")}`):(global._firebaseAdminApp=r.initializeApp({credential:r.credential.cert(i)}),console.log("Firebase Admin SDK initialized successfully (via globalThis). Once."),console.log("Initialized Firebase App instance:",global._firebaseAdminApp.name),console.log("Project ID:",i.project_id))}else console.error(`Firebase service account file not found at: ${e}`),console.error("Please ensure the file exists and the path is correct.")}catch(e){throw console.error("Firebase admin initialization error:",e),console.error("Please check:"),console.error("1. The service account JSON file is valid"),console.error("2. The service account has proper permissions"),console.error("3. The FIREBASE_ADMIN_SDK_PATH is correct"),Error("Failed to initialize Firebase Admin SDK. Check FIREBASE_ADMIN_SDK_PATH and file content.")}else console.error("Firebase Admin SDK path is missing. Admin SDK will not be initialized."),console.error("Please set FIREBASE_ADMIN_SDK_PATH in your .env.local file")}let l=global._firebaseAdminApp;l||console.error("Admin SDK failed to initialize. Exported functions will not work.");let u=l?l.firestore():null,d=l?l.auth():null;u&&console.log("adminDb initialized. Project ID:",l?.options.projectId),d&&console.log("adminAuth initialized.")},3954:(e,t,i)=>{i.a(e,async(e,r)=>{try{i.r(t),i.d(t,{default:()=>a});var n=i(6090),o=i(3951),s=e([n]);let c=new(n=(s.then?(await s)():s)[0]).default(process.env.STRIPE_SECRET_KEY||"",{apiVersion:"2025-10-29.clover"});async function a(e,t){if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});try{let{userId:i}=e.body;if(!i)return t.status(400).json({error:"Missing userId"});if(!o.i)return t.status(500).json({error:"Firebase Admin SDK not initialized"});let r=o.i.collection("users").doc(i),n=await r.get();if(!n.exists)return t.status(200).json({hasAccount:!1,status:"none"});let s=n.data(),a=s?.stripeAccountId;if(!a)return t.status(200).json({hasAccount:!1,status:"none"});let l=await c.accounts.retrieve(a),u=l.details_submitted&&l.charges_enabled?"active":"pending";await r.update({stripeAccountStatus:u}),t.status(200).json({hasAccount:!0,accountId:a,status:u,detailsSubmitted:l.details_submitted,chargesEnabled:l.charges_enabled,payoutsEnabled:l.payouts_enabled})}catch(e){console.error("Stripe account status error:",e),t.status(500).json({error:e.message||"Failed to check account status"})}}r()}catch(e){r(e)}})},7153:(e,t)=>{var i;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return i}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(i||(i={}))},1802:(e,t,i)=>{e.exports=i(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var i=t(t.s=5631);module.exports=i})();